<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8"/>
  <title>geolocation</title>
<style>

  html, body {
      height: 100%;
      margin: 0px;
      padding: 0px;
  }
  
  #map {
      height: 100%;
      background-color: #dff;
  }
  
</style>
</head>
<body>
  <h1>map</h1>
  <div id="res"></div>
  <div id="map"></div>
<script>

  //
  var map = null;
  var mark = null;
  var cnt = 0;
  
  window.addEventListener('DOMContentLoaded', () => {

      var canv = document.getElementById("map");
      var res = document.getElementById("res");

      if(navigator.geolocation) {

	  navigator.geolocation.watchPosition((pos) => {

	      var lat = pos.coords.latitude;
	      var lng = pos.coords.longitude;

	      var latlng = {lat: lat, lng: lng};
	      
	      map = new google.maps.Map(canv, {
		  center: latlng,
		  zoom: 11
	      });

	      mark = new google.maps.Marker({
		  position: latlng,
		  map: map
	      });

	      cnt++;
	      var str = "<b>" + cnt + "å›ž</b>\n";
	      str += "<p><b>lat: </b>" + lat + " <b>lng: </b>" + lng + "</p>\n";
	      str += new Date(pos.timestamp).toLocaleString();
	      str += "\n<hr/>\n";

	      res.innerHTML = str;
	      console.log(str);

	  },(err) => {

	      console.log(err);

	  });
	  
      }

  });
  
</script>
</body>
</html>
